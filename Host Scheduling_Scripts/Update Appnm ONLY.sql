declare @FromModel varchar(20)
declare @ToModel varchar(20)
declare @FromAppnm varchar(10)
declare @ToAppnm varchar(10)
declare @FromAppnm1 varchar(10)
declare @ToAppnm1 varchar(10)
-- 2 Modify the 4 variables below accordingly

--
  --SET @FromModel='Vx-520'
  --SET @ToModel='Vx-520'
  SET @FromModel='Vx-675'
  SET @ToModel='Vx-675'
  --SET @FromModel='Vx-820'
  --SET @ToModel='Vx-820'
--
SET @FromAppnm='EPOS0210P'
SET @ToAppnm='EPOS0211P'
SET @FromAppnm1='EPOS0210'
SET @ToAppnm1='EPOS0211'

--- --------
--

insert into vc30.RELATION
(FAMNM,APPNM,TERMID,CLUSTERID,ACCCNT,LASTFULL,LASTPAR,ACCCODE,VIOLATIONCOUNT,LOCKED,MODON,MODBY,LOCKTIMESTAMP,EPROMID,DESCRIPTION,DLD_STATUS,
ISAUTODOWNLOAD,LAST_ATTEMPTED_DLD_DATE,VERSION,LASTPARAM_DLD_DATE,LASTFILE_DLD_DATE,FORUSES,FORMVIEWTYPE,SERVERID,TERM_FILE_UPDATES,
FORCEFILEDLD,FORCEPARAMDLD,FORCETERMFILEDLD)
select @ToModel,@ToAppnm,TERMID,CLUSTERID,ACCCNT,NULL,NULL,ACCCODE,0,LOCKED,getdate(),
'SCRIPT1',NULL,NULL,DESCRIPTION,NULL,'N',NULL,NULL,NULL,NULL,FORUSES,FORMVIEWTYPE,NULL,TERM_FILE_UPDATES,'D','D','D'
from vc30.relation
where famnm = @FromModel and appnm = @FromAppnm
-- for specific terminal
and TERMID in

('675INTER','73000983','73000987','73000992','73000997','73001005','73001009','73001013','73001019','73001022','73001025','73001029','73001001','73001032','73001035','73001040','73001043','73001048','73001053','73002657','73002779','73002881','73002886','73002890','73002894','73002898','73002902','73002906','73002931','73002934','73002938','73002941','73002945','73002948','73002951','73002954','73003043','73003117','73003752','73004771','73005509','73005781','73006221','73006222','73006321','73006712','73006776','73006779','73006832','73002910','73002913','73002917','73002920','73002924','73002928','73002958','73002978','73002982','73003040','73006873','73006874','73006875','73006876','73006877','73007306','73007373','73007376','73007443','73007632')


-- 4 Create new parameters app on all TIDs in the target model based on the TIDs found in the source model and app name combination.

insert into vc30.RELATION
(FAMNM,APPNM,TERMID,CLUSTERID,ACCCNT,LASTFULL,LASTPAR,ACCCODE,VIOLATIONCOUNT,LOCKED,MODON,MODBY,LOCKTIMESTAMP,EPROMID,DESCRIPTION,DLD_STATUS,
ISAUTODOWNLOAD,LAST_ATTEMPTED_DLD_DATE,VERSION,LASTPARAM_DLD_DATE,LASTFILE_DLD_DATE,FORUSES,FORMVIEWTYPE,SERVERID,TERM_FILE_UPDATES,
FORCEFILEDLD,FORCEPARAMDLD,FORCETERMFILEDLD)
select @ToModel,@ToAppnm1,TERMID,CLUSTERID,ACCCNT,NULL,NULL,ACCCODE,0,LOCKED,getdate(),
'SCRIPT1',NULL,NULL,DESCRIPTION,NULL,'N',NULL,NULL,NULL,NULL,FORUSES,FORMVIEWTYPE,NULL,TERM_FILE_UPDATES,'D','D','D'
from vc30.relation
where famnm = @FromModel and appnm = @FromAppnm1
-- for specific terminal
and TERMID in

('675INTER','73000983','73000987','73000992','73000997','73001005','73001009','73001013','73001019','73001022','73001025','73001029','73001001','73001032','73001035','73001040','73001043','73001048','73001053','73002657','73002779','73002881','73002886','73002890','73002894','73002898','73002902','73002906','73002931','73002934','73002938','73002941','73002945','73002948','73002951','73002954','73003043','73003117','73003752','73004771','73005509','73005781','73006221','73006222','73006321','73006712','73006776','73006779','73006832','73002910','73002913','73002917','73002920','73002924','73002928','73002958','73002978','73002982','73003040','73006873','73006874','73006875','73006876','73006877','73007306','73007373','73007376','73007443','73007632')


-- 5 Copy parameters from source app to target app
insert into vc30.PARAMETER (FAMNM, APPNM, PARTID, PARNAMELOC, SEQINFO, DLDTYPE,PARINFO, VALUE,PSIZE,FLAG)
select @ToModel model,@ToAppnm, PARTID, PARNAMELOC, SEQINFO, DLDTYPE,PARINFO, VALUE,PSIZE,FLAG
from vc30.parameter
where famnm = @FromModel and appnm in (@FromAppnm, @FromAppnm1)
-- for specific terminal
and PARTID in

('675INTER','73000983','73000987','73000992','73000997','73001005','73001009','73001013','73001019','73001022','73001025','73001029','73001001','73001032','73001035','73001040','73001043','73001048','73001053','73002657','73002779','73002881','73002886','73002890','73002894','73002898','73002902','73002906','73002931','73002934','73002938','73002941','73002945','73002948','73002951','73002954','73003043','73003117','73003752','73004771','73005509','73005781','73006221','73006222','73006321','73006712','73006776','73006779','73006832','73002910','73002913','73002917','73002920','73002924','73002928','73002958','73002978','73002982','73003040','73006873','73006874','73006875','73006876','73006877','73007306','73007373','73007376','73007443','73007632')


-- Copy Parameters from one app to another app
-- 1 *NOTE: Ensure that the new app is created first in the target Model using Model/App Manager

update vc30.term_dld_files
set appnm = @ToAppnm
where famnm = @FromModel and appnm = @FromAppnm
AND termid in

('675INTER','73000983','73000987','73000992','73000997','73001005','73001009','73001013','73001019','73001022','73001025','73001029','73001001','73001032','73001035','73001040','73001043','73001048','73001053','73002657','73002779','73002881','73002886','73002890','73002894','73002898','73002902','73002906','73002931','73002934','73002938','73002941','73002945','73002948','73002951','73002954','73003043','73003117','73003752','73004771','73005509','73005781','73006221','73006222','73006321','73006712','73006776','73006779','73006832','73002910','73002913','73002917','73002920','73002924','73002928','73002958','73002978','73002982','73003040','73006873','73006874','73006875','73006876','73006877','73007306','73007373','73007376','73007443','73007632')


--------------------------------------------------

-- 6.1 Delete old parameters
delete from vc30.RELATION
where famnm = @FromModel and appnm = @FromAppnm
-- for specific terminal
and TERMID in

('675INTER','73000983','73000987','73000992','73000997','73001005','73001009','73001013','73001019','73001022','73001025','73001029','73001001','73001032','73001035','73001040','73001043','73001048','73001053','73002657','73002779','73002881','73002886','73002890','73002894','73002898','73002902','73002906','73002931','73002934','73002938','73002941','73002945','73002948','73002951','73002954','73003043','73003117','73003752','73004771','73005509','73005781','73006221','73006222','73006321','73006712','73006776','73006779','73006832','73002910','73002913','73002917','73002920','73002924','73002928','73002958','73002978','73002982','73003040','73006873','73006874','73006875','73006876','73006877','73007306','73007373','73007376','73007443','73007632')


-- 6.2 Delete old parameters
delete from vc30.RELATION
where famnm = @FromModel and appnm = @FromAppnm1
-- for specific terminal
and TERMID in

('675INTER','73000983','73000987','73000992','73000997','73001005','73001009','73001013','73001019','73001022','73001025','73001029','73001001','73001032','73001035','73001040','73001043','73001048','73001053','73002657','73002779','73002881','73002886','73002890','73002894','73002898','73002902','73002906','73002931','73002934','73002938','73002941','73002945','73002948','73002951','73002954','73003043','73003117','73003752','73004771','73005509','73005781','73006221','73006222','73006321','73006712','73006776','73006779','73006832','73002910','73002913','73002917','73002920','73002924','73002928','73002958','73002978','73002982','73003040','73006873','73006874','73006875','73006876','73006877','73007306','73007373','73007376','73007443','73007632')


-- ------
--
update vc30.PARAMETER set value = 'TEPOS0211P' where parnameloc = 'USES' and partid in
('675INTER','73000983','73000987','73000992','73000997','73001005','73001009','73001013','73001019','73001022','73001025','73001029','73001001','73001032','73001035','73001040','73001043','73001048','73001053','73002657','73002779','73002881','73002886','73002890','73002894','73002898','73002902','73002906','73002931','73002934','73002938','73002941','73002945','73002948','73002951','73002954','73003043','73003117','73003752','73004771','73005509','73005781','73006221','73006222','73006321','73006712','73006776','73006779','73006832','73002910','73002913','73002917','73002920','73002924','73002928','73002958','73002978','73002982','73003040','73006873','73006874','73006875','73006876','73006877','73007306','73007373','73007376','73007443','73007632')

GO
