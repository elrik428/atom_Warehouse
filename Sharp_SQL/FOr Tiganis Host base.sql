DECLARE
FromTM char(5) := '2300';
ToTM char(5) := '0700';
FnalDat char(12) := '  '


select distinct 'LIP', TER_TID , '*APPL','yymmddhhmmss', '02', '2119894412FFFFFFFFFFFFFF','YYMMDD','220000', 'N', '0','0', 'CYYMMDD','220000', 'TIGANIS', 'QPADEV000P'
FROM TERMINAL where TER_TID not in (select TER_TID from TERMINAL where      TER_START_FILE_DL > '26/06/18' and (TER_UNSUCC_FILE_DL < TER_START_FILE_DL or TER_UNSUCC_FILE_DL is null))

CREATE TABLE HOSTBASE_TEMP
(
  F1 VARCHAR2(20)
, F2 VARCHAR2(20)
, F3 VARCHAR2(20)
, F4 VARCHAR2(20)
, F5 VARCHAR2(20)
, F6 VARCHAR2(26)
, F7 VARCHAR2(20)
, F8 VARCHAR2(20)
, F9 VARCHAR2(20)
, F10 VARCHAR2(20)
, F11 VARCHAR2(20)
, F12 VARCHAR2(20)
, F13 VARCHAR2(20)
, F14 VARCHAR2(20)
, F15 VARCHAR2(20)
);

INSERT INTO HOSTBASE_TEMP  (F1,F2,F3,F4,F5,F6,F7,F8,F9,F10,F11,F12,F13,F14,F15)
VALUES ('LIP', termID , '*APPL',tempdate#1, '02', '2119894412FFFFFFFFFFFFFF',tempdate#2,'220000', 'N', '0','0', tempdate#3,'220000', 'TIGANIS', 'QPADEV000P');



--- Inegenico LAst Call 
SELECT ter_tid,TER_START_FILE_DL,TER_UNSUCC_FILE_DL, TER_SUCC_FILE_DL
 ,             TER_START_PARAM_DL, TER_UNSUCC_PARAM_DL, TER_SUCC_PARAM_DL
FROM TERMINAL
WHERE TERMINAL.TER_TID NOT IN
  (SELECT TERMINAL.TER_TID
  FROM TERMINAL
  WHERE TERMINAL.TER_START_FILE_DL > '26/06/18'
  AND (TERMINAL.TER_UNSUCC_FILE_DL < TERMINAL.TER_START_FILE_DL
  OR TERMINAL.TER_UNSUCC_FILE_DL  IS NULL)
  )
