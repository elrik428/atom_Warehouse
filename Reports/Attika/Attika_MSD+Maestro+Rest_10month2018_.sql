

select 'MSD-MAESTRO',mid,
CASE MID
WHEN '000000001100001' THEN	'ATTIKA_PANEPISTIMIOU'
WHEN '000000001100001' THEN	'ATTIKA_PANEPISTIMIOU'
WHEN '000000001100010' THEN	'ATTIKA_GOLDEN_HALL'
WHEN '000000001100011' THEN	'ATTIKA_THESSALONIKI'
WHEN '000000001100013' THEN	'ATTIKA_KALYVIA'
WHEN '000000001100014' THEN	'ATTIKA_MALL'
WHEN '000000001100015' THEN	'ATTIKA_STADIOU'
WHEN '000000001100016' THEN	'ATTIKA_CASUAL_THESNIKI'
WHEN '000000001100017' THEN	'ATTIKA_TSIMISKI'
WHEN '000000001100018' THEN	'ATTIKA_COSMOS_CARELAB'
WHEN '000000001100019' THEN	'ATTIKA_ARMANI_GOLDEN_HALL'
WHEN '000000001100020' THEN 'ATTIKA_KALOGIROU_GOLDEN_HALL'
ELSE 'unknown'
END,
  sum (case substring(PROCCODE, 1, 2)
  when '00' then +AMOUNT
  when '20' then -AMOUNT
  when '02' then -AMOUNT
  when '22' then -AMOUNT
  end) Total_amount,
count(*)
from abc096.IMP_TRANSACT_D_tempLN
where substring(mask,1,2) in ('50','51','52','53','54','55','56','57','58','59','60','61','63','64','65','66','67','68','69') and RESPKIND = 'OK'
group by mid
order by mid



select 'REST',mid,
CASE MID
WHEN '000000001100001' THEN	'ATTIKA_PANEPISTIMIOU'
WHEN '000000001100010' THEN	'ATTIKA_GOLDEN_HALL'
WHEN '000000001100011' THEN	'ATTIKA_THESSALONIKI'
WHEN '000000001100013' THEN	'ATTIKA_KALYVIA'
WHEN '000000001100014' THEN	'ATTIKA_MALL'
WHEN '000000001100015' THEN	'ATTIKA_STADIOU'
WHEN '000000001100016' THEN	'ATTIKA_CASUAL_THESNIKI'
WHEN '000000001100017' THEN	'ATTIKA_TSIMISKI'
WHEN '000000001100018' THEN	'ATTIKA_COSMOS_CARELAB'
WHEN '000000001100019' THEN	'ATTIKA_ARMANI_GOLDEN_HALL'
WHEN '000000001100020' THEN 'ATTIKA_KALOGIROU_GOLDEN_HALL'
ELSE 'unknown'
END,
  sum (case substring(PROCCODE, 1, 2)
  when '00' then +AMOUNT
  when '20' then -AMOUNT
  when '02' then -AMOUNT
  when '22' then -AMOUNT
  end) Total_amount,
count(*)
from abc096.IMP_TRANSACT_D_tempLN
where substring(mask,1,2) not in ('50','51','52','53','54','55','56','57','58','59','60','61','63','64','65','66','67','68','69') and RESPKIND = 'OK'
group by mid
order by mid


select 'ALL',mid,
CASE MID
WHEN '000000001100001' THEN	'ATTIKA_PANEPISTIMIOU'
WHEN '000000001100001' THEN	'ATTIKA_PANEPISTIMIOU'
WHEN '000000001100010' THEN	'ATTIKA_GOLDEN_HALL'
WHEN '000000001100011' THEN	'ATTIKA_THESSALONIKI'
WHEN '000000001100013' THEN	'ATTIKA_KALYVIA'
WHEN '000000001100014' THEN	'ATTIKA_MALL'
WHEN '000000001100015' THEN	'ATTIKA_STADIOU'
WHEN '000000001100016' THEN	'ATTIKA_CASUAL_THESNIKI'
WHEN '000000001100017' THEN	'ATTIKA_TSIMISKI'
WHEN '000000001100018' THEN	'ATTIKA_COSMOS_CARELAB'
WHEN '000000001100019' THEN	'ATTIKA_ARMANI_GOLDEN_HALL'
WHEN '000000001100020' THEN 'ATTIKA_KALOGIROU_GOLDEN_HALL'
ELSE 'unknown'
END,
  sum (case substring(PROCCODE, 1, 2)
  when '00' then +AMOUNT
  when '20' then -AMOUNT
  when '02' then -AMOUNT
  when '22' then -AMOUNT
  end) Total_amount,
 count(*)
from abc096.IMP_TRANSACT_D_tempLN
where RESPKIND = 'OK'
group by mid
order by mid
