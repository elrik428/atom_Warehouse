select  'CTLS:YES /  MSD:YES','10/03/2018-06/04/2018',a.MID,b.Merchant, count(*) Transactions_number, sum(amount) Transactions_Amount from [abc096].IMP_TRANSACT_D_2018 a
join abc096.mids b on a.MID = b.MID
where
a.MID in ('000000001100001','000000001100010','000000001100017','000000001100011','000000001100013','000000001100014','000000001100015','000000001100016','B00000001100001','B00000001100010','B00000001100011','000000001100018','000000001100019')
and substring(mask,1,6) in ('510001',
'510015',
'510053',
'510053',
'510053',
'510053',
'510053',
'510053',
'510053',
'510053',
'510053',
'510053',
'510099',
'510155',
'510424',
'511673',
'512476',
'512802',
'513814',
'515877',
'516032',
'516273',
'516273',
'516273',
'516273',
'516281',
'516281',
'516281',
'516297',
'516616',
'516616',
'516616',
'516616',
'516616',
'516616',
'516616',
'516616',
'516616',
'516616',
'516732',
'516838',
'518281',
'518418',
'518516',
'518517',
'518518',
'518519',
'518589',
'518666',
'518677',
'518730',
'518900',
'518992',
'520304',
'520949',
'520949',
'520949',
'520949',
'520949',
'520949',
'520949',
'520949',
'520949',
'520949',
'521098',
'522072',
'522581',
'524596',
'524870',
'526093',
'527346',
'527346',
'527346',
'527455',
'527455',
'527455',
'527455',
'527651',
'527651',
'527651',
'527651',
'527651',
'527651',
'527651',
'527651',
'527651',
'527651',
'527651',
'527651',
'527651',
'527651',
'527651',
'527800',
'527801',
'527802',
'527803',
'527804',
'527805',
'527890',
'527891',
'527892',
'527893',
'528055',
'528582',
'528582',
'528582',
'528818',
'528818',
'528818',
'528818',
'528818',
'528818',
'528818',
'528818',
'528818',
'528818',
'528818',
'528818',
'528818',
'528818',
'528818',
'528818',
'528818',
'528818',
'528818',
'528818',
'528818',
'528818',
'529017',
'529048',
'529485',
'529548',
'529548',
'529548',
'529548',
'529584',
'530074',
'530075',
'530075',
'530075',
'530075',
'530075',
'530075',
'530075',
'530075',
'530075',
'530075',
'530464',
'531146',
'531239',
'531423',
'531423',
'531524',
'531979',
'531979',
'531979',
'531979',
'531979',
'531979',
'531979',
'531979',
'531979',
'531979',
'532192',
'533598',
'533808',
'533808',
'533808',
'533808',
'533808',
'533808',
'533815',
'533824',
'533840',
'533845',
'533939',
'533939',
'533939',
'533939',
'533939',
'533939',
'533939',
'533939',
'533986',
'534093',
'534093',
'534096',
'534153',
'534228',
'534229',
'534229',
'534229',
'534316',
'534316',
'534316',
'534316',
'534316',
'534578',
'534578',
'534578',
'534578',
'534578',
'534578',
'534578',
'534578',
'534804',
'534804',
'534804',
'535018',
'535054',
'535054',
'535054',
'535142',
'535143',
'535195',
'535267',
'535298',
'535298',
'535298',
'535420',
'535448',
'535448',
'535500',
'535500',
'535500',
'535521',
'535521',
'535523',
'535548',
'535551',
'535573',
'535584',
'535584',
'535585',
'535585',
'535586',
'535586',
'535590',
'535590',
'535591',
'535658',
'535658',
'536843',
'537440',
'537465',
'537465',
'537465',
'537465',
'537465',
'537465',
'537465',
'537465',
'537465',
'537465',
'537465',
'537465',
'537465',
'537465',
'537465',
'537465',
'537465',
'537486',
'537486',
'537488',
'537488',
'537488',
'537488',
'537488',
'537488',
'537488',
'537488',
'537488',
'537488',
'537488',
'537488',
'537488',
'537488',
'537488',
'537488',
'537488',
'537488',
'537488',
'537488',
'537488',
'537489',
'537489',
'537489',
'537489',
'537489',
'537489',
'537489',
'537489',
'537489',
'537489',
'537489',
'537489',
'537534',
'537535',
'537574',
'537574',
'537574',
'537574',
'537574',
'537574',
'537574',
'537574',
'537574',
'537574',
'537574',
'537574',
'537574',
'537574',
'537574',
'537582',
'537582',
'537582',
'537582',
'537582',
'537583',
'537583',
'537583',
'537583',
'537583',
'537587',
'537587',
'537590',
'537590',
'537590',
'537590',
'537590',
'537591',
'537591',
'537591',
'537591',
'537591',
'538732',
'538732',
'538732',
'538732',
'538895',
'538982',
'538982',
'539123',
'539123',
'539247',
'539247',
'539247',
'539248',
'539263',
'539263',
'539263',
'539263',
'539731',
'540186',
'540574',
'541308',
'541309',
'541310',
'541348',
'541348',
'541348',
'541871',
'542230',
'542230',
'542230',
'542230',
'542230',
'542297',
'542862',
'543018',
'543074',
'543750',
'544136',
'544136',
'544441',
'545095',
'545255',
'545255',
'545255',
'545865',
'546470',
'546471',
'546716',
'547261',
'548182',
'548372',
'549474',
'549804',
'549885',
'550076',
'550106',
'550113',
'552053',
'552202',
'552215',
'553262',
'554208',
'554209',
'554272',
'554502',
'554626',
'554626',
'554626',
'554714',
'554760',
'557347',
'557347',
'557347',
'557347',
'557378',
'557389',
'557871',
'557956',
'558483')
--and substring(a.MASK,1,2) between '50' and '59'
 --and MONTH(a.DTSTAMP) in('4')
 and DTSTAMP >='2018-03-10 00:00:01' and DTSTAMP <='2018-04-06 00:00:01'
 and  substring(POSDATA,1,2) in ('07','91')
group by a.MID,b.Merchant
