SELECT dbo_TRANSLOG_TRANSACT_temp.Mid AS MID, dbo_TRANSLOG_TRANSACT_temp.Tid AS TID, Switch([DESTCOMID]='NET_EBNK','EUROBANK',[DESTCOMID]='NET_ALPHA','ALPHABANK',[DESTCOMID]='NET_ABC','PIRAEUS BANK',[DESTCOMID]='NET_NTBN','NATIONAL BANK') AS BANK, dbo_TRANSLOG_TRANSACT_temp.DTSTAMP, dbo_TRANSLOG_TRANSACT_temp.MSGID, dbo_TRANSLOG_TRANSACT_temp.TAMOUNT AS AMOUNT, dbo_TRANSLOG_TRANSACT_temp.TAUTHCODE AS AUTHCODE, dbo_TRANSLOG_TRANSACT_temp.MASK AS CARD, dbo_TRANSLOG_TRANSACT_temp.PROCCODE, Switch(left([PROCCODE],2)='00','SALE',left([PROCCODE],2)='02','VOID',left([PROCCODE],2)='20','REFUND',left([PROCCODE],2)='22','VOID REFUND') AS TYPE, dbo_TRANSLOG_TRANSACT_temp.INST, dbo_TRANSLOG_TRANSACT_temp.RESPKIND, dbo_TRANSLOG_TRANSACT_temp.TRESPONSE AS RESPONSE, dbo_TRANSLOG_TRANSACT_temp.DMID AS DESTMID, dbo_TRANSLOG_TRANSACT_temp.DTID AS DESTTID
FROM dbo_TRANSLOG_TRANSACT_temp
WHERE dbo_TRANSLOG_TRANSACT_temp.MID In ('000000120005700','000000120005710','000000120005720','000000120005730') And dbo_TRANSLOG_TRANSACT_temp.INST > 0
ORDER BY dbo_TRANSLOG_TRANSACT_temp.DTSTAMP;
