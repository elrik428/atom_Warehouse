SELECT
distinct t1.termid as TID,
case (substring(t1.appnm,1,4))
when 'EPOS' then 'EPOS'
when 'PIRA' then 'PIRAEUS BANK'
else '????????'
end,
t1.CLUSTERID,
--acccode as [S/N-1],
--[S/N-2] =(select serialnumber from vc30.TERMINFO where utid=(select utid from vc30.TERMIDTOUTID where vc30.TERMIDTOUTID.TERMID = vc30.relation.termid and substring(appnm,1,4) in ('PIRA','EPOS') and substring(appnm,9,1) = ('P') and substring(termid,1,1) < '5' and famnm = vc30.relation.famnm)),
t1.famnm as [TERMINAL TYPE],
t2.PARNAMELOC,
t2.value

FROM
vc30.relation t1 FULL OUTER JOIN vc30.PARAMETER t2 ON t1.TERMID = t2.PARTID
--(vc30.relation t1 LEFT  JOIN vc30.PARAMETER t2 ON t1.TERMID = t2.PARTID and ((select value from vc30.PARAMETER b where b.PARTID=t1.termid and b.PARNAMELOC='SERVICES_ENABLED' and substring(b.appnm,1,4) = 'PIRA') = 'TRUE') )
where
t2.PARNAMELOC in (
--'EXTINFO'
--'MERCHID','LOGO_PROMO','LOTTERYMC','LOTTERYFROM','LOTTERYTO'
-- 'MEDIA','HOST_IP','HOST_IP2',
-- 'RECEIPT_LINE_1', 'RECEIPT_LINE_2', 'RECEIPT_LINE_3', 'RECEIPT_LINE_4'
--'NBG_MID','NBG_TID','LOYALTY_NBG','PBG_MID','PNBG_TID','LOYALTY_PBG'
--'MERCHID','RECEIPT_LINE_1','RECEIPT_LINE_2','RECEIPT_LINE_3','RECEIPT_LINE_4','LOYALTY_EUROBANK',
--'LOYALTY_EUROBANK_ELS','LOYALTY_CITIBANK','LOYALTY_BONUS','LOYALTY_NBG','LIFECARD_LTY',
--'SERVICES_MID','TERMID_NCC','TERMID_HOST','SERVICES_TID','SERVICES_IP','SERVICES_IP2','SERVICES_ENABLED',
--'DCCCAPABLE','MEDIA','ETH.DHCP','HOST_IP','HOST_IP2','HOST_IP_GPRS','HOST_IP_GPRS2','TMS_IP','ACCTYPE',
--'BONUS_MID','BONUS_TID','NBG_MID','NBG_TID''TRANS_INIT','DLL_CONN','CONFIG_APN'
--'HOST_IP','HOST_IP2','SERVICES_IP','SERVICES_IP2','BONUS_IP','BONUS_IP2'
'TERMID_NCC','MERCHID','RECEIPT_LINE_1','RECEIPT_LINE_2','RECEIPT_LINE_3','RECEIPT_LINE_4','HOST_IP','HOST_IP2',
--'TERMID_NCC','TERMID_HOST','MERCHID','RECEIPT_LINE_1','RECEIPT_LINE_2','RECEIPT_LINE_3','RECEIPT_LINE_4','ETH.DHCP','DLL_CONN','COSMOTE'
--'TERMID_NCC','NBG_MID','NBG_TID','LOYALTY_NBG'
--'BONUS_MID','BONUS_TID','LOYALTY_EUROBANK','LOYALTY_EUROBANK_ELS','LOYALTY_BONUS','LOYALTY_NBG','LOYALTY_PBG','NBG_MID','NBG_TID','PBG_MID','PBG_TID','ETH.IPADDR','ETH.SUBNET','ETH.GATEWAY'
--'TERMID_NCC','TERMID_HOST','MERCHID','RECEIPT_LINE_1','RECEIPT_LINE_2','RECEIPT_LINE_3','RECEIPT_LINE_4','HOST_IP','HOST_IP2','ETH.DHCP','DLL_CONN','TMS_IP'
'ETH.IPADDR','ETH.SUBNET','ETH.GATEWAY','MEDIA','ETH.DHCP','TRANS_INIT','DLL_CONN','CONFIG_APN','LOYALTY_BONUS','LOYALTY_EUROBANK','LOYALTY_NBG','LOYALTY_PBG',
'ETH.IPADDR','ETH.SUBNET','ETH.GATEWAY','HOST_IP','HOST_IP2','TMS_IP','ETH_PORT', 'TMS_ETH_PORT'
--'MERCHID','LOYALTY_EUROBANK','LOYALTY_EUROBANK_ELS','LOYALTY_CITIBANK','LOYALTY_BONUS','LOYALTY_NBG','LIFECARD_LTY','LOYALTY_PBG'
'DCCCAPABLE', 'SMARTPAD','MAXINST'
--'MERCHID','MANUALENTRY'
)
--and value like '%1100009%'
--and t1.CLUSTERID =
--in ('TIRANA')
--('EPOS_DUTYFREE')
and t1.acccnt = -1
and len(t1.appnm) = 9
and substring(t1.appnm,1,4) in (
  --  'PIRA',
    'EPOS'
--'TIRA'
    )
and substring(t1.termid,1,2) = '73'
and substring(t1.termid,1,1) <> ('T')
--  and TERMID in
-- ('73000829','73000809','73000712','73000827','73000819','73000803','73000831','73000816','73000711','73000830','73000811','73000822','73000804','73000820','73000825','73000810','73000813','73000818','73000828','73000826','73000823','73000821','73000713','73000812','73000814','73000817','73000815','73000808','73000824','73001185','73003130','73001473','73002690','73002691','73000836','73000837','73000832','73000840','73000845','73000838','73000833','73000835','73000841','73000839','73000842','73000834','73000844','73003561','73003560','73003559','73002772','73001191','73001475','73001472','01292943','73002751','73003128','73003133','73002697','01368890','73002692','73003058','73002695','01263712','73001193','73003055','01263710','73001460','73002683','73007240','73007239','73002678','01306881','73001184','73002685','73003056','01292940','73001458','73005877','73001195','73002673','73001190','01292941','73002672','73001471','73003057','73002707','73006891','73001189','73003054','73001477','73002699','73006890','01946260','73006888','01429820','73002775','73002702','01063411','73001192','73002675','73002700','73002684','73002668','73001508','73001507','73001504','73001513','73001514','73001521','73001516','73001506','73001512','73001505','73001510','73001519','73001515','73001520','73001517','73001522','73001518','73001525','73001523','73001524','73001488','73001490','73001484','73001501','73001491','73001503','73001498','73001483','73001492','73001494','73001487','73003053','73001474','73005956','73005954','73006887','73002687','73001463','73002701','73002686','73001187','01006950','73003135','73001464','73002744','73001466','73001186','73001459','73002670','01264730','01946250','73001467','73002694','73001468','73002786','73003098','73005953','73001469','73001499','73002703','73005955','73001461','73006798','73001489','73001465','73002556','73001486','73006889','73005952','73002696','73002674','73002680','73002677','73002688')
--
order by t1.termid, t2.PARNAMELOC
